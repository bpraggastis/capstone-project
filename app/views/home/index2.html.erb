<h1>Disease Tracks  .....  </h1>

<div id="disease-list" class="basic-block">
  <h2>Medical Conditions</h2>
    <div class="query-form" id="condition-query">
      <%= form_tag '/', method: :get do %>
        <p>
          <%= label_tag :condition_query %>
          <%= text_field_tag :condition_query, params[:condition_query] %>
          <%= submit_tag :search %>
        </p>
        <!-- put %end here if wish to break up queries -->
    </div>
  <div class="scrolling-list">
    <ol>
      <% @conditions.each do |condition| %>
        <li> <strong><%= HomeController::hilite(condition.name, @cquery) %></strong> <br>
          Description: <br>
            <%= condition.description[0,250] if condition.description %>
            <!-- Button trigger modal -->
              <button class="btn" data-toggle="modal"
                 data-target="#myModal">
                 read more ...
              </button>
            <br>      <!-- Modal -->
              <div class="modal fade" id="myModal" tabindex="-1" role="dialog"
                 aria-labelledby="myModalLabel" aria-hidden="true">
                 <div class="modal-dialog">
                    <div class="modal-content">
                       <div class="modal-header">
                          <!-- <button type="button" class="close"
                             data-dismiss="modal" aria-hidden="true">
                                &times;
                          </button> -->
                          <h4 class="modal-title" id="myModalLabel">
                             <%= condition.name %>
                          </h4>
                       </div>
                       <div class="modal-body">
                          <%= condition.description if condition.description %>
                       </div>
                       <div class="modal-footer">
                          <button type="button"
                             data-dismiss="modal">Close
                          </button>
                          <!-- <button type="button" class="btn btn-primary">
                             Submit changes
                          </button> -->
                       </div>
                    </div><!-- /.modal-content -->
              </div><!-- /.modal -->
          Codes: <br>
          <ul>
              <% condition.codes.each do |code| %>
                <% if code.code_system == "image" %>
                  <li><img src="<%= code.code_value %>" width="100px" height="100px" alt="" />
                  </li>
                <% else %>
                <li>
                  <%= code.code_system %>: <%= code.code_value %>
                </li>
                <% end %>
              <% end %>
          </ul>
          All Known Names: <br>
          <ul>
              <% condition.alternate_names.each do |alt_name| %>
              <li>
                  <%= HomeController::hilite(alt_name.name, @cquery)%>
                </li>
              <% end %>
          </ul>
          Preventions:<br>
          <ul>
            <% condition.preventions.each do |therapy| %>
            <li>
              <%= therapy.name %>
            </li>
            <% end %>
          </ul>
        </li>
        </li>
      <% end %>
    </ol>
  </div>
</div>

<div id="drug-list" class="basic-block">
  <h2>Drug Therapies</h2>
    <div class="query-form" id="therapy-query">
 <!-- put %= form_tag here if wish to break up queries -->
        <p>
          <%= label_tag :therapy_query %>
          <%= text_field_tag :therapy_query, params[:therapy_query] %>
          <%= submit_tag :search %>
        </p>
      <% end %>
    </div>
  <div class="scrolling-list">
    <ol>
      <% @therapies.each do |therapy| %>
      <li>
        <strong><%= HomeController::hilite(therapy.name, @tquery) %></strong>: <%= HomeController::hilite(therapy.description, @tquery) %>
        <br>
        <ul>

        <% therapy.codes.each do |code| %>
          <li>
            <%= code.code_system %>: <%= code.code_value %>
          </li>
        <% end %>

      </ul>
      </li>
      <% end %>
    </ol>
  </div>
</div>
